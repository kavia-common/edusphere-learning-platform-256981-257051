{"is_source_file": true, "format": "JavaScript", "description": "This file defines utility functions, configuration constants, and functions for subscribing to real-time metrics updates, as well as fetching counts of courses, active learners, and recent completions for the EduSphere Learning Platform's frontend metrics service.", "external_files": ["../lib/supabaseClient"], "external_methods": ["getSupabase"], "published": ["subscribeToMetrics", "fetchCoursesCount", "fetchActiveLearnersCount", "fetchRecentCompletionsCount", "fetchAllMetrics"], "classes": [], "methods": [{"name": "subscribeToMetrics({ onChange, signal } = {})", "description": "Initializes real-time subscriptions to presence and analytics events, invoking callbacks on data changes, and returns a cleanup function.", "scope": "", "scopeKind": ""}, {"name": "fetchCoursesCount()", "description": "Fetches and returns the total number of courses from the database.", "scope": "", "scopeKind": ""}, {"name": "fetchActiveLearnersCount()", "description": "Calculates and returns the current number of active learners based on presence or recent activity.", "scope": "", "scopeKind": ""}, {"name": "fetchRecentCompletionsCount()", "description": "Calculates and returns the number of recent completions within the configured time window.", "scope": "", "scopeKind": ""}, {"name": "fetchAllMetrics()", "description": "Fetches all key metrics\u2014active learners, total courses, and recent completions\u2014simultaneously.", "scope": "", "scopeKind": ""}, {"name": "isoMinutesAgo(minutes)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "safeCount(val)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["getSupabase", "client.from", "client.select", "client.gte", "client.eq", "client.removeChannel", "fetchActiveLearnersCount", "fetchRecentCompletionsCount", "fetchCoursesCount"], "search-terms": ["realtime metrics", "supabase channels", "active learners", "courses count", "completions", "analytics events", "presence table", "subscription", "metrics configuration"], "state": 2, "file_id": 59, "knowledge_revision": 167, "git_revision": "500e781b3d967fa789eb4454773d7afc1e8beed9", "revision_history": [{"156": ""}, {"161": ""}, {"162": ""}, {"163": ""}, {"164": "500e781b3d967fa789eb4454773d7afc1e8beed9"}, {"167": "500e781b3d967fa789eb4454773d7afc1e8beed9"}], "ctags": [{"_type": "tag", "name": "METRICS_CONFIG", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export const METRICS_CONFIG = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "activeWindowMinutes", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  activeWindowMinutes: 15,$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "analyticsEventsTable", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  analyticsEventsTable: 'analytics_events',$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "completionEventName", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  completionEventName: 'completion',$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "completionWindowMinutes", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  completionWindowMinutes: 1440, \\/\\/ 24 hours$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "coursesTable", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  coursesTable: 'courses',$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "fetchActiveLearnersCount", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export async function fetchActiveLearnersCount() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fetchAllMetrics", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export async function fetchAllMetrics() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fetchCoursesCount", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export async function fetchCoursesCount() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fetchRecentCompletionsCount", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export async function fetchRecentCompletionsCount() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "isoMinutesAgo", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^function isoMinutesAgo(minutes) {$/", "language": "JavaScript", "kind": "function", "signature": "(minutes)"}, {"_type": "tag", "name": "presenceTable", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^  presenceTable: 'user_presence',$/", "language": "JavaScript", "kind": "property", "scope": "METRICS_CONFIG", "scopeKind": "class"}, {"_type": "tag", "name": "safeCount", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^function safeCount(val) {$/", "language": "JavaScript", "kind": "function", "signature": "(val)"}, {"_type": "tag", "name": "subscribeToMetrics", "path": "/home/kavia/workspace/code-generation/edusphere-learning-platform-256981-257051/edusphere_frontend/src/services/metrics.js", "pattern": "/^export function subscribeToMetrics({ onChange, signal } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "({ onChange, signal } = {})"}], "hash": "3f1160763257929f7a2ce05167fff205", "format-version": 4, "code-base-name": "edusphere_frontend", "filename": "edusphere_frontend/src/services/metrics.js", "fields": [{"name": "activeWindowMinutes: 15,", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "analyticsEventsTable: 'analytics_events',", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "completionEventName: 'completion',", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "completionWindowMinutes: 1440, \\/\\/ 24 hours", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "coursesTable: 'courses',", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}, {"name": "presenceTable: 'user_presence',", "scope": "METRICS_CONFIG", "scopeKind": "class", "description": "unavailable"}]}